
import sys
import binascii
from apk_parse.apk import APK

def getActivity(filename):
    result = ""
    apkf = APK(filename)
    activities = apkf.get_activities()
    packageName = apkf.get_package()
    for activity in activities:
        result +="activity::"+activity.replace(packageName,'') +'\n'
    return result

def getPermission(filename):
    result = ""
    apkf = APK(filename)
    permissions = apkf.get_permissions()
    for permission in permissions:
        result +="permission::"+permission +'\n'
    return result
def getInterFilter(filename):
    result =""
    apkf = APK(filename)
    services = apkf.get_services()
    for service in services:
        for action,intent_name in apkf.get_intent_filters('service', service).items():               
                for intent in intent_name:
                        result +='intent::' + intent +'\n'
    receivers = apkf.get_receivers() 
    for receiver in receivers:              
        for action,intent_name in apkf.get_intent_filters('receiver', receiver).items():               
                for intent in intent_name:
                        result +='intent::' + intent +'\n'
    activities = apkf.get_activities()
    for activity in activities:     
        for action,intent_name in apkf.get_intent_filters('activity',activity).items():              
                for intent in intent_name:                      
                        result +='intent::' + intent +'\n'
    return result
def getService(filename):
    result =""
    apkf = APK(filename)
    services = apkf.get_services()
    for service in services:
        result +='service::'+service + '\n'
    return result


def getAPKManifestInfo(filename):
    result = ""
    result +=getActivity(filename)
    result +=getPermission(filename)
    result +=getInterFilter(filename)
    result +=getService(filename)
    return result





